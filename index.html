<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grammar Challenge: Used To</title>
    <style>
        :root {
            --primary: #4e54c8;
            --success: #28a745;
            --error: #dc3545;
            --accent: #f59e0b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), 
                        url('https://images.unsplash.com/photo-1497633762265-9d179a990aa6?auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        .quiz-container {
            width: 95%;
            max-width: 650px;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            backdrop-filter: blur(5px);
            text-align: center;
        }

        h1 { color: var(--primary); margin-bottom: 5px; font-size: 1.8rem; }
        .subtitle { color: #555; margin-bottom: 25px; font-weight: 500; }

        .input-group { margin-bottom: 20px; text-align: left; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
        input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            box-sizing: border-box;
        }

        .question-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 5px solid var(--primary);
            text-align: left;
        }
        .sentence { font-size: 1.15rem; line-height: 1.6; color: #333; }
        .verb-hint { background: #fff3cd; color: #856404; padding: 2px 6px; border-radius: 4px; font-weight: bold; }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            color: white;
            margin-top: 10px;
        }
        .btn-primary { background: var(--primary); }
        .btn-check { background: var(--accent); }
        .btn-next { background: var(--success); }
        .btn:hover { opacity: 0.9; transform: translateY(-2px); }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            display: none;
        }
        .correct { display: block; background: #d4edda; color: #155724; }
        .incorrect { display: block; background: #f8d7da; color: #721c24; }

        .progress-text { font-weight: bold; color: var(--primary); margin-bottom: 10px; }
        #quizSection, #resultsSection { display: none; }
    </style>
</head>
<body>

<div class="quiz-container">
    <div id="startSection">
        <h1>üìù Grammar Master</h1>
        <p class="subtitle">Used to / Didn't use to / Did ... use to?</p>
        <div class="input-group">
            <label for="studentName">Student Name:</label>
            <input type="text" id="studentName" placeholder="Enter your name to start">
        </div>
        <button class="btn btn-primary" onclick="startQuiz()">Start Quiz (10 Random Questions)</button>
    </div>

    <div id="quizSection">
        <div class="progress-text" id="progress">Question 1 of 10</div>
        <div class="question-box">
            <div id="sentence" class="sentence"></div>
        </div>
        <input type="text" id="answerInput" placeholder="Type answer here..." autocomplete="off">
        <div id="feedback" class="feedback"></div>
        
        <button id="checkBtn" class="btn btn-check" onclick="checkAnswer()">Check Answer</button>
        <button id="nextBtn" class="btn btn-next" onclick="nextQuestion()" style="display:none">Next Question</button>
    </div>

    <div id="resultsSection">
        <h1>Quiz Complete!</h1>
        <p id="finalScore" style="font-size: 1.4rem; font-weight: bold;"></p>
        <p id="statusMsg" style="color: #666;"></p>
        <button class="btn btn-primary" onclick="location.reload()">Try 10 New Questions</button>
    </div>
</div>

<audio id="soundCorrect" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
<audio id="soundWrong" src="https://assets.mixkit.co/active_storage/sfx/2959/2959-preview.mp3"></audio>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz6QvFAjEmRJi-L3MJw4b4cCduPyeVX1YO6Ij-b-5DdUX9fgH6u1j5SfefcvutM_8vf/exec";

    const questionBank = [
        { verb: "live", answer: "used to live", sentence: "I ___ in the city, but now I live in the countryside." },
        { verb: "travel", answer: "didn't use to travel", sentence: "They ___ abroad, but now they travel frequently." },
        { verb: "work", answer: "used to work", sentence: "She ___ in an office, but now she works from home." },
        { verb: "eat", answer: "didn't use to eat", sentence: "We ___ healthy food, but now we eat it every day." },
        { verb: "play", answer: "used to play", sentence: "He ___ the guitar, but now he doesn't play anymore." },
        { verb: "study", answer: "did you use to study", sentence: "___ French when you were at school?" },
        { verb: "like", answer: "didn't use to like", sentence: "I ___ vegetables, but now I love them." },
        { verb: "go", answer: "used to go", sentence: "They ___ swimming every weekend, but now they rarely go." },
        { verb: "wear", answer: "didn't use to wear", sentence: "She ___ makeup, but now she wears it daily." },
        { verb: "have", answer: "used to have", sentence: "We ___ a dog, but now we have two cats." },
        { verb: "smoke", answer: "used to smoke", sentence: "My grandfather ___ forty cigarettes a day." },
        { verb: "be", answer: "didn't use to be", sentence: "That building ___ a cinema, but now it is a luxury hotel." },
        { verb: "drive", answer: "did you use to drive", sentence: "___ a car before you moved to the city?" },
        { verb: "have", answer: "didn't use to have", sentence: "I ___ a mobile phone when I was a child." },
        { verb: "walk", answer: "used to walk", sentence: "We ___ to school every morning, rain or shine." },
        { verb: "love", answer: "did she use to love", sentence: "___ classical music when she was younger?" },
        { verb: "watch", answer: "used to watch", sentence: "They ___ cartoons every Saturday morning." },
        { verb: "exercise", answer: "didn't use to exercise", sentence: "He ___ at all, but now he runs marathons." },
        { verb: "stay", answer: "did you use to stay", sentence: "___ out late on school nights?" },
        { verb: "visit", answer: "used to visit", sentence: "We ___ our grandparents every summer holiday." },
        { verb: "cook", answer: "didn't use to cook", sentence: "My brother ___ , but now he is a professional chef." },
        { verb: "be", answer: "used to be", sentence: "There ___ a large tree in front of our house." },
        { verb: "read", answer: "did they use to read", sentence: "___ bedtime stories to you when you were little?" },
        { verb: "spend", answer: "used to spend", sentence: "I ___ all my pocket money on comic books." },
        { verb: "speak", answer: "didn't use to speak", sentence: "He ___ English, but now he is very fluent." },
        { verb: "believe", answer: "did you use to believe", sentence: "___ in ghosts when you were a kid?" },
        { verb: "wear", answer: "used to wear", sentence: "She ___ glasses, but now she has contact lenses." },
        { verb: "help", answer: "didn't use to help", sentence: "They ___ with the housework, but now they do." },
        { verb: "ride", answer: "used to ride", sentence: "I ___ my bike everywhere before I got my license." },
        { verb: "enjoy", answer: "did he use to enjoy", sentence: "___ playing football at school?" },
        { verb: "listen", answer: "used to listen", sentence: "We ___ to the radio every evening." },
        { verb: "go", answer: "didn't use to go", sentence: "They ___ to the gym, but now they go daily." },
        { verb: "be", answer: "did you use to be", sentence: "___ afraid of the dark?" },
        { verb: "own", answer: "used to own", sentence: "My father ___ a vintage red sports car." },
        { verb: "like", answer: "didn't use to like", sentence: "I ___ olives, but now I can't live without them." },
        { verb: "buy", answer: "used to buy", sentence: "We ___ bread from the small bakery on the corner." },
        { verb: "travel", answer: "did your parents use to travel", sentence: "___ a lot for work?" },
        { verb: "know", answer: "didn't use to know", sentence: "I ___ how to swim, but I learned last year." },
        { verb: "take", answer: "used to take", sentence: "She ___ the bus, but now she walks to work." },
        { verb: "have", answer: "did you use to have", sentence: "___ long hair when you were a teenager?" },
        { verb: "play", answer: "didn't use to play", sentence: "He ___ video games until he bought that console." },
        { verb: "clean", answer: "used to clean", sentence: "My mother ___ the house every single Saturday." },
        { verb: "meet", answer: "did you use to meet", sentence: "___ your friends at the park after school?" },
        { verb: "work", answer: "used to work", sentence: "I ___ at a restaurant during my summer breaks." },
        { verb: "cry", answer: "didn't use to cry", sentence: "She ___ much as a baby, she was very quiet." },
        { verb: "be", answer: "used to be", sentence: "It ___ much cheaper to buy a house in this area." },
        { verb: "get", answer: "did you use to get", sentence: "___ good grades in history class?" },
        { verb: "sleep", answer: "used to sleep", sentence: "I ___ until noon on Sundays." },
        { verb: "complain", answer: "didn't use to complain", sentence: "He ___ about the weather, but now he does." },
        { verb: "study", answer: "used to study", sentence: "We ___ in the library every afternoon." },
        { verb: "think", answer: "did you use to think", sentence: "___ that the earth was flat?" },
        { verb: "dance", answer: "used to dance", sentence: "She ___ ballet before she injured her knee." },
        { verb: "feel", answer: "didn't use to feel", sentence: "I ___ confident about public speaking." },
        { verb: "collect", answer: "did he use to collect", sentence: "___ stamps when he was a boy?" },
        { verb: "shout", answer: "used to shout", sentence: "Our old teacher ___ at us all the time." },
        { verb: "understand", answer: "didn't use to understand", sentence: "I ___ math, but now it makes sense." },
        { verb: "write", answer: "used to write", sentence: "She ___ letters to her penpal every month." },
        { verb: "jump", answer: "did you use to jump", sentence: "___ on the trampoline when you were little?" },
        { verb: "hate", answer: "used to hate", sentence: "I ___ broccoli, but now I love it." },
        { verb: "share", answer: "didn't use to share", sentence: "They ___ their toys with each other." },
        { verb: "watch", answer: "did you use to watch", sentence: "___ the news when you were younger?" },
        { verb: "run", answer: "used to run", sentence: "He ___ every morning before breakfast." },
        { verb: "wear", answer: "didn't use to wear", sentence: "I ___ a tie to work, but now I have to." },
        { verb: "bring", answer: "used to bring", sentence: "They ___ us presents whenever they visited." },
        { verb: "talk", answer: "did you use to talk", sentence: "___ to your stuffed animals?" },
        { verb: "be", answer: "used to be", sentence: "There ___ a fountain in the middle of the square." },
        { verb: "rain", answer: "didn't use to rain", sentence: "It ___ so much in this part of the country." },
        { verb: "sing", answer: "used to sing", sentence: "She ___ in the church choir every Sunday." },
        { verb: "lose", answer: "did you use to lose", sentence: "___ your keys as often as you do now?" },
        { verb: "wake up", answer: "used to wake up", sentence: "I ___ at 5 AM to go to the market." }
    ];

    let quizSet = [];
    let currentIdx = 0;
    let score = 0;
    let studentName = "";
    let sessionLogs = [];

    function startQuiz() {
        studentName = document.getElementById('studentName').value.trim();
        if (!studentName) {
            alert("Please enter your name!");
            return;
        }
        
        // Shuffle and pick 10 random questions
        quizSet = [...questionBank].sort(() => 0.5 - Math.random()).slice(0, 10);
        
        currentIdx = 0;
        score = 0;
        sessionLogs = [];
        
        document.getElementById('startSection').style.display = 'none';
        document.getElementById('quizSection').style.display = 'block';
        loadQuestion();
    }

    function loadQuestion() {
        const q = quizSet[currentIdx];
        document.getElementById('progress').innerText = `Question ${currentIdx + 1} of 10`;
        document.getElementById('sentence').innerHTML = q.sentence.replace('___', `<span class="verb-hint">(${q.verb})</span> _______`);
        document.getElementById('answerInput').value = "";
        document.getElementById('answerInput').disabled = false;
        document.getElementById('feedback').className = 'feedback';
        document.getElementById('checkBtn').style.display = 'block';
        document.getElementById('nextBtn').style.display = 'none';
        document.getElementById('answerInput').focus();
    }

    function checkAnswer() {
        const userAns = document.getElementById('answerInput').value.trim().toLowerCase();
        const correctAns = quizSet[currentIdx].answer.toLowerCase();
        const feedbackDiv = document.getElementById('feedback');

        if (!userAns) return;

        const isCorrect = userAns === correctAns;
        if (isCorrect) {
            score++;
            feedbackDiv.innerText = "‚úì Correct!";
            feedbackDiv.className = "feedback correct";
            document.getElementById('soundCorrect').play();
        } else {
            feedbackDiv.innerHTML = `‚úó Incorrect. Answer: <strong>${quizSet[currentIdx].answer}</strong>`;
            feedbackDiv.className = "feedback incorrect";
            document.getElementById('soundWrong').play();
        }

        sessionLogs.push(`Q${currentIdx+1}: ${isCorrect ? '‚úì' : '‚úó'} (${userAns})`);
        document.getElementById('answerInput').disabled = true;
        document.getElementById('checkBtn').style.display = 'none';
        document.getElementById('nextBtn').style.display = 'block';
    }

    function nextQuestion() {
        currentIdx++;
        if (currentIdx < 10) {
            loadQuestion();
        } else {
            showFinalResults();
        }
    }

    function showFinalResults() {
        document.getElementById('quizSection').style.display = 'none';
        document.getElementById('resultsSection').style.display = 'block';
        const percent = (score / 10) * 100;
        document.getElementById('finalScore').innerText = `${studentName}, your score: ${score}/10 (${percent}%)`;
        submitToSheets(percent);
    }

    function submitToSheets(percentage) {
        document.getElementById('statusMsg').innerText = "Sending to spreadsheet...";
        const payload = {
            timestamp: new Date().toLocaleString(),
            name: studentName,
            score: score,
            total: 10,
            percentage: percentage + "%",
            details: sessionLogs.join(" | ")
        };

        fetch(SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            body: JSON.stringify(payload)
        }).then(() => {
            document.getElementById('statusMsg').innerText = "‚úÖ Saved to Sheets!";
        }).catch(() => {
            document.getElementById('statusMsg').innerText = "Done!";
        });
    }

    document.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            if (document.getElementById('checkBtn').style.display !== 'none') checkAnswer();
            else if (document.getElementById('nextBtn').style.display !== 'none') nextQuestion();
        }
    });
</script>
</body>
</html>
